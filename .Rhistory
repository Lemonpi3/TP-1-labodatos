)
knitr::include_graphics("Estaciones destino primer semestre.png")
graphs = map(1:6, ~plot_estacion_destino_mes(mes = .x))
g = grid.arrange(grobs = graphs)
ggsave(
"Assets/img/Estaciones destino primer semestre.png",
g,
device = agg_png,
width =10, height = 6, units = "cm", res = 1900,
scaling = 0.3
)
knitr::include_graphics("Estaciones destino primer semestre.png")
graphs = map(7:12, ~plot_estacion_destino_mes(mes = .x))
g = grid.arrange(grobs = graphs)
ggsave(
"Assets/img/Estaciones destino segundo semestre.png",
g,
device = agg_png,
width =10, height = 6, units = "cm", res = 1900,
scaling = 0.3
)
library(gridExtra)
graphs = map(1:6, ~plot_estacion_destino_mes(mes = .x))
g = grid.arrange(grobs = graphs)
ggsave(
"Assets/img/Estaciones destino primer semestre.png",
g,
device = agg_png,
width =10, height = 6, units = "cm", res = 900,
scaling = 0.3
)
knitr::include_graphics("Estaciones destino primer semestre.png")
ggsave(
"Assets/img/Estaciones destino primer semestre.png",
g,
device = agg_png,
width =6, height = 3, units = "cm", res = 900,
scaling = 0.3
)
library(gridExtra)
graphs = map(1:6, ~plot_estacion_destino_mes(mes = .x))
g = grid.arrange(grobs = graphs)
ggsave(
"Assets/img/Estaciones destino primer semestre.png",
g,
device = agg_png,
width =6, height = 3, units = "cm", res = 900,
scaling = 0.3
)
library(gridExtra)
graphs = map(1:6, ~plot_estacion_destino_mes(mes = .x))
g = grid.arrange(grobs = graphs)
ggsave(
"Assets/img/Estaciones destino primer semestre.png",
g,
device = agg_png,
width =10, height = 6, units = "cm", res = 1900,
scaling = 0.3
)
knitr::include_graphics("Estaciones destino primer semestre.png")
ggsave(
"Assets/img/Estaciones destino segundo semestre.png",
g,
device = agg_png,
width =10, height = 6, units = "cm", res = 1900,
scaling = 0.3
)
knitr::include_graphics("Estaciones destino segundo semestre.png")
#pongan Imports ,funciones y setups globales de los graficos que usen aca
require(tidyverse)
require(sf)
require(showtext)
df_bici = read_csv('Data/Bicis_limpio.csv')
df_clima = read_csv('Data/Clima_limpio.csv')
#el archivo descomprimido era muy grande para github
unzip("Assets/shapefiles/mapa_calles/callejero.zip", exdir = "Assets/shapefiles/mapa_calles")
mapa = st_read("Assets/shapefiles/mapa_calles") %>%
st_transform( "+proj=longlat +ellps=WGS84 +datum=WGS84")
#fuentes
font_add("PlexSans",
italic = "Assets/fonts/IBM_Plex_Sans/IBMPlexSans-Light.ttf" ,
bold="Assets/fonts/IBM_Plex_Sans/IBMPlexSans-Bold.ttf",
regular ="Assets/fonts/IBM_Plex_Sans/IBMPlexSans-Regular.ttf" )
showtext_auto()
plot_estacion_destino_mes = function(mes){
meses = c("Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre")
return(df_bici %>%
filter(lubridate::month(fecha_destino_recorrido)== lubridate::month(mes)) %>%
group_by(nombre_estacion_destino) %>%
summarise(
n_viajes = n_distinct(id_recorrido),
mes = lubridate::month(fecha_destino_recorrido)[1]
) %>%
arrange(desc(n_viajes)) %>%
top_n(10, n_viajes) %>%
head(10) %>%
mutate(
str_wrap(nombre_estacion_destino, width = 5),
top_3 = ifelse((n_viajes>=n_viajes[3]), "Top 3", "Others"),
) %>%
ggplot(aes(x=nombre_estacion_destino, y= n_viajes, level=nombre_estacion_destino, fill = top_3))+
geom_col() +
geom_text(aes(label=n_viajes), vjust = 1.5, colour = "black") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
labs(
title = "Top 10 Cantidad de viajes",
subtitle = str_glue("{mes} 2022", mes =meses[mes])
) +
theme(
plot.title = element_text(size = 18, family ="PlexSans Regular", color = "white"),
plot.subtitle = element_text(size = 12, family = "PlexSans Italic", color = "grey80"),
plot.margin = margin(10, 30, 10, 50),
axis.ticks.x = element_line(colour= "white"),
axis.text.x = element_text(size = 8, family ="PlexSans Regular", color = "white"),
legend.position = "none"
) +
scale_fill_manual(values = c("Top 3" = "#affc41", "Others" = "gray80"),guide=F)
)
}
require(gridExtra)
graphs = map(1:6, ~plot_estacion_destino_mes(mes = .x))
grid.arrange(grobs = graphs)
theme_set(theme_minimal())
theme_update(
plot.background = element_rect(fill = "#0b132b"),
panel.background = element_rect(fill = "#0b132b", colour = "#0b132b"),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.text = element_text(color = "white"),
legend.title = element_text(color = "white")
)
graphs = map(1:6, ~plot_estacion_destino_mes(mes = .x))
grid.arrange(grobs = graphs)
theme_set(theme_minimal())
theme_update(
plot.background = element_rect(fill = "#0b132b"),
panel.background = element_rect(fill = "#0b132b", colour = "#0b132b"),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.text = element_text(color = "white"),
legend.title = element_text(color = "white")
)
graphs = map(1:6, ~plot_estacion_destino_mes(mes = .x))
grid.arrange(grobs = graphs)
theme_set(theme_minimal())
theme_update(
plot.background = element_rect(fill = "#0b132b"),
panel.background = element_rect(fill = "#0b132b", colour = "#0b132b"),
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
legend.text = element_text(color = "white"),
legend.title = element_text(color = "white")
)
graphs = map(7:12, ~plot_estacion_destino_mes(mes = .x))
grid.arrange(grobs = graphs)
grid.arrange(grobs = graphs)
grid.arrange(grobs = graphs)
graphs = map(7:12, ~plot_estacion_destino_mes(mes = .x))
g = grid.arrange(grobs = graphs)
df_bici %>%
group_by(fecha) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=fecha, y= n_viajes)) +
geom_col() +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici %>%
group_by(fecha) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=fecha, y= n_viajes)) +
geom_polygon() +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
geom_poly
col
df_bici %>%
group_by(fecha) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=fecha, y= n_viajes)) +
geom_col() +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici %>%
group_by(fecha) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=fecha, y= n_viajes)) +
geom_line() +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici %>%
group_by(fecha) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=fecha, y= n_viajes)) +
geom_line(width=5) +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici %>%
group_by(fecha) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=fecha, y= n_viajes)) +
geom_line(size=5) +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici %>%
group_by(fecha) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=fecha, y= n_viajes)) +
geom_line(size=2) +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici %>%
group_by(fecha) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=fecha, y= n_viajes)) +
geom_line(size=3) +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici %>%
group_by(fecha) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=fecha, y= n_viajes)) +
geom_line(size=1) +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici %>%
group_by(fecha) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=fecha, y= n_viajes)) +
geom_point(size=1) +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici %>%
group_by(fecha) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=fecha, y= n_viajes)) +
geom_point() +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici %>%
group_by(semana = lubridate::week(fecha)) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=fecha, y= n_viajes)) +
geom_point() +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici %>%
group_by(semana = lubridate::week(fecha)) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=fecha, y= n_viajes)) +
geom_point() +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici %>%
group_by(semana = lubridate::week(fecha)) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=fecha, y= n_viajes)) +
geom_point() +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici
df_bici %>%
group_by(semana = lubridate::week(fecha_origen_recorrido)) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=semana, y= n_viajes)) +
geom_point() +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici %>%
group_by(semana = lubridate::week(fecha_origen_recorrido)) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=semana, y= n_viajes)) +
geom_point() +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici %>%
group_by(semana = lubridate::week(fecha)) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=semana, y= n_viajes)) +
geom_point() +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=semana, y= n_viajes)) +
geom_point() +
geom_smooth() +
scale_x_date(date_labels="%b", date_breaks  ="month")
df_bici %>%
mutate(
semana = lubridate::week(fecha)
)
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
)
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=semana, y= n_viajes))
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=semana, y= n_viajes)) +
geom_col() +
geom_smooth()
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=semana, y= n_viajes)) +
geom_line() +
geom_smooth()
col
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=semana, y= n_viajes)) +
geom_col() +
geom_smooth()
?seq
max(df_bici %>%
mutate(
semana = lubridate::week(fecha)
)$semana)
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
max = max(semana)
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
max = max(semana)
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
arrange(desc(F))
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
arrange(desc(T))
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
arrange(desc(semana))
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=semana, y= n_viajes)) +
geom_col() +
geom_smooth() +
scale_x_continuous(seq(1:53,4))
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=semana, y= n_viajes)) +
geom_col() +
geom_smooth() +
scale_x_continuous(seq(from = 1, to = 53,by =4))
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=semana, y= n_viajes)) +
geom_col() +
geom_smooth() +
scale_x_continuous(breaks =seq(from = 1, to = 53,by =4))
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=semana, y= n_viajes)) +
geom_col() +
geom_smooth() +
scale_x_continuous(breaks =seq(from = 1, to = 53,by =4))
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=semana, y= n_viajes)) +
geom_col() +
geom_smooth() +
scale_x_continuous(breaks =seq(from = 1, to = 53,by =4))
df_bici %>%
mutate(
semana = lubridate::week(fecha)
) %>%
group_by(semana) %>%
summarise(
n_viajes = n_distinct(id_recorrido)
) %>%
ggplot(aes(x=semana, y= n_viajes)) +
geom_col() +
geom_smooth() +
scale_x_continuous(breaks =seq(from = 1, to = 53,by =4)) +
theme_classic()
